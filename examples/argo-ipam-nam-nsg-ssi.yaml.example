apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: ipam-nam-nsg-ssi-qa # ipam-nam-nsg-ssi-<environment>
  namespace: argocd

spec:
  destination:
    namespace: ssi
    server: https://kubernetes.default.svc
  project: default
  source:
    chart: dcn-ipam-nam-nsg-ssi
    helm:
      valueFiles:
      - values.yaml
      - env/qa.yaml #test, qa, prod
      parameters:
        - name: settings.continuousMode
          value: "true" # True for continuous mode (Pod), false for one shot mode (CronJob)
        - name: settings.interval
          value: "300" #Seconds for continuous mode (Pod)
        - name: schedule
          value: "*/5 * * * *" # Used for one shot mode (CronJob)
        - name: credentials.namToken
          value: "<NAM_TOKEN_HERE>"
        - name: credentials.ipamToken
          value: "<IPAM_TOKEN_HERE>"
        - name: credentials.splunkToken
          value: "<SPLUNK_TOKEN_HERE>" 
    repoURL: ncr.sky.nhn.no/ghcr/norskhelsenett/helm
    targetRevision: "*"
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
    - CreateNamespace=true